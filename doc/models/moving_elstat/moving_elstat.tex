\chapter{Electrostatics of moving rigid bodies}\label{Electrostatics}

\modinfo{Module name}{\Idx{MovingElstatSolver}}
\modinfo{Module subroutines}{\Idx{MovingElstatSolver}}
\begin{versiona}
\modinfo{Module authors}{Peter Råback}
\modinfo{Document authors}{Peter Råback}
\modinfo{Document created}{26.1.2006}
\modinfo{Document edited}{17.5.2006}


\section{Introduction}

\index{rigid body movement}
This solver is tailored for solving electrostatic problems that 
occur in the movement of rigid bodies in respect to one another. 
Here the movement is assumed to be a combination of rotations and 
translations. We are mostly interested in lumped quantities. 
The most important quantity is the capacitance of the moving body 
at different positions. In addition the sensitivity of the capacitance
and the moment of the electric force may be computed. The information is
saved in a generic tabulated form and also as a lumped circuit model
of Aplac. 

For a more generic cases of the electrostatics and
mesh adaptation the user is encouraged to use the 
existing separate solvers. 


\section{Electrostatics}

Assuming a constant permittivity $\varepsilon$, 
absence of free charges, and non-conducting 
media the equation for the electrostatic potential $\phi$ yields,
\begin{equation}
  -\varepsilon \nabla \cdot \nabla \phi = 0.
\end{equation}
Obviously the constant multiplier may be dropped for convenience.

The energy of the electric field may be computed from
\begin{equation}
  E  = \frac{1}{2}\varepsilon \int_\Omega |\nabla \phi|^2 d\Omega.
\end{equation}
If there is only one potential difference $\Phi$ present then the 
capacitance $C$ may be computed from
\begin{equation}
  C = \frac{2E}{\Phi^2} .
\end{equation} 

The electric force is calculated by integrating the 
electrostatic \Idx{Maxwell stress tensor} over the specified surface. Using
the stress tensor $\overline{\overline T}$ the total force on the
surface $S$ can be expressed as
\begin{equation}
\Vec{F} = \int_S \overline{\overline T}\cdot\Vec{n}\,dS.
\end{equation}
The components of the Maxwell stress tensor for linear medium are
\begin{equation}
T_{ij} = -D_iE_j + \frac{1}{2}\delta_{ij}\Vec{D}\cdot\Vec{E},
\end{equation}
where electric field $\vec{E}$ and electric displacement field
$\vec{D}$ are obtained from 
\begin{equation}
\vec{E} = -\nabla\phi,
\end{equation}
and
\begin{equation}
\vec{D} = -\varepsilon \nabla \phi.
\end{equation}
The moment around a given point $\Vec{r}_0$ is given by,
\begin{equation}
\Vec{F} = \int_S \overline{\overline T}\cdot\Vec{n}\times 
(\Vec{r}-\Vec{r}_0)\,dS.
\end{equation}

One may get an secondary estimation for the capacitance from the integral of the 
surface charges. 
\begin{equation}
  C' = \Inv{\Phi} \int_S \Vec{D} \cdot \Vec{n}\, dS .
\end{equation}
This estimate of capacitance has a much bigger numerical error than the one defined
by the volume integral. However the estimate may be usufull in evaluating the 
accuracy of the capacitance. The volume integral approaches the exact capacitance from
above while the surface integral approaches it from below.  



\section{Mesh movement}

The generic mesh movement of Elmer is based on a linear elasticity model. 
This is often an overkill since this makes the solution of the mesh movement
computationally much more expensive than the solution of the potential
equation. Therefore in the mesh movement it is assumed that the 
displacements of the main direction $u_i$, $i={1,2,3}$ are independent.
Then the displacement of each directions is given by the 
Laplace equation
\begin{equation}
  - \nabla \cdot \nabla u_i = 0.
\end{equation}

The obvious boundary conditions for the displacements would be to fix
the displacements at all walls. However, for large movement this 
would distort the mesh unnecessaryly. Therefore the displacements are
fixed only in the direction of the surface normal. Thus, if the normal
is the main direction, the other two components are free to slide. 
This approach is unfortunately feasible only for rectangular geometries. 
Also the displacements of the 
mesh points at the outer boundaries will be fixed.
An outer boundary is assumed to be moving if it is somewhere attached to the moving 
body, otherwise it is assumed to be at rest.

For the moving rigid body the displacements are given by three 
translational $U_i$ and  three rotational $\Phi_i$ degrees of freedom.
Then the displacement at the moving wall yields
\begin{equation}
  \vec{u} = \Vec{U} + \Matr{R}(\vec{r}-\vec{r}_0),
\end{equation}
where 
\begin{equation}
  R = \left( \begin{array}{ccc} 
        0  & \Phi_z & -\Phi_y \\
         -\Phi_z  & 0 & -\Phi_x \\
       \Phi_y  & \Phi_x & 0 
        \end{array} \right )
\end{equation}

It should be noted that if the movement of the frame is pure translational 
then there may be no need to solve the displacements in all directions
since the Laplace has a non-zero solution only if some of the boundary conditions
is non-zero. 



\section{Implimentation issues}

For simple equations, such as the Laplace equation, a large part of the computational
effort goes into the assembly of the linear equation. In this special case the same matrix 
may be assemblied only once and used repetitively to solve the mesh 
adaption problem varying just  the boundary conditions. Unfortunately, the potential 
equation must every time be reassembled as the coordinates change. 

The purpose of the simulation is to get detailed information of the 
capacitance in respect with the rigid body movement. However, as
there are six degrees of freedom making just 10 observations in each direction would 
result to $10^6$, that is a million, simulations. Therefore it is advisable to make 
the observations only to some predefined directions. For this purpose the user may give 
up to six basis $\Vec{\eta}_i$ to define these directions. By default $\eta_{ij}=\delta_{ij}$.

For each basis $\Vec{\eta}_i$ the user may also give the interval of the amplitude $[a_i,b_i]$ and the
number of observation points $N_i$. Then the rigid body coordinates are
\begin{equation}
  \Vec{U} = \sum_{i=1}^6  \left(a_i + (n_i-1) \frac{b_i-a_i}{N_i-1}\right) \, \Vec{\eta}_i .
\end{equation}


\section{Keywords}

\end{versiona}


\sifbegin
\sifitemnt{Constants}{}
\sifbegin
\sifitemnt{Permittivity Of Vacuum}{Real [8.8542e-12]}
\sifend

\sifitemnt{Solver}{solver id}
\sifbegin
\sifitemnt{Equation}{String MovingElstatSolver}
\sifitem{Variable}{String Potential}
This may be of any name as far as it is used consistently also elsewhere.
\sifitem{Variable DOFs}{Integer 1}
Degrees of freedom for the potential.
\sifitem{Procedure}{File "MovingElstatSolver"\ "MovingElstatSolver"}
Following are listed four keywords with default values for 
output control.
\sifitem{Moment About i}{Real}
The center of coordinate system ($i=1,2,3$) for the rigid body movement and for computing the moments. 
\sifitem{Lumping Basis j(6)}{Real}
The basis $\Vec{\eta}_j$, $j=1,2,\ldots,6$.
\sifitem{Lumping Points j}{Integer}
Number of observations for basis $j$.
\sifitem{Lumping Interval j(2)}{Real}
The interval of amplitude for basis $j$.
\sifitem{Length Scale}{Real}
The Aplac export assumes certain unit system. Therefore if the length unit of the mesh is not given 
in metres this value may be given to recsale the results appropriately.
\sifitem{Calculate Force}{Logical [True]}
Whether to calculate and save the force lumped force.
\sifitem{Calculate Moment}{Logical [True]}
Whether to calculate and save the force lumped moments..
\sifitem{Save Displacements}{Logical True}
Whether to save the displacement field in the ElmerPost format.
\sifitem{Filename}{File}
All the results are saved in the file given by this keyword. Additionally 
a suffix \texttt{.info} is given to file that explains what is being saved. 
Finally, if Aplac model is created, it is given the suffix \texttt{.aplac}.
\sifend

\sifitemnt{Boundary Condition}{bc id}
\sifbegin
\sifitemnt{Potential}{Real}
\sifitem{Moving Boundary}{Logical}
If this is true then displacements are fixed using the rigid body movement and
potential is given value one. 
\sifitem{Fixed Boundary}{Logical}
If this is true then displacements are fixed to zero in normal direction 
and potential is given value zero. 
\sifitem{Periodic BC Potential}{Logical}
Periodic boundary conditions for the potential is activated by this keyword.
Note that this affects only the potential solution. The displacements at the symmetric
boundaries are fixed internally to zero. 
\sifitem{Periodic BC}{Integer}
The periodic counterpart of the current Boundary Conditions. 
\sifitem{Periodic BC Translate(3)}{Real}
This keyword is required for the older versions of Elmer code to give the translational
vector of the periodicity.
\sifend

\sifend


%\bibliography{elmerbib}
%\bibliographystyle{plain}

