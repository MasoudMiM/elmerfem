\Chapter{Magnetic Induction Equation}
\noindent
\modinfo{Module name}{included in solver / MagneticSolve as external procedure}
\modinfo{Module subroutines}{\Idx{MagneticSolver}}
\begin{versiona}
\modinfo{Module authors}{Juha Ruokolainen}
\modinfo{Document authors}{Ville Savolainen, Antti Pursula}
\modinfo{Document edited}{May 24th 2005}

\section{Introduction}

The magnetic \Idx{induction equation} describes interaction of a conducting
liquid or gas with applied and induced magnetic fields in the low-frequency
domain. The induction equation for the magnetic flux density is always coupled
to the Navier-Stokes equation for the movement of the fluid. The magnetic
field, in turn, causes the Lorentz force in the Navier-Stokes equation. The
fluid is typically hot, and the Navier-Stokes equation is often coupled also
to the heat equation.

The induction equation solver can also be used in a body without a moving
fluid, i.e., when $\vec{v}=0$ and the Navier-Stokes equation is not solved.
In this case, the problem belongs to the field of magneto-quasistatics.

\section{Theory}

The magnetic induction equation may be derived from the Maxwell's equations,
with the displacement current in Amp\`{e}re's law neglected, and the Ohm's law
for conducting fluids,
$\vec{\jmath} = \sigma ( \vec{E} + \vec{v}\times\vec{B} )$. This approximation
for the behavior of electromagnetic
fields in conducting, moving fluids is called \Idx{magnetohydrodynamics}.

The magnetic induction equation is given by
\begin{equation}
\frac{\partial \vec{B}}{\partial t} + \frac{1}{\sigma\mu}\nabla\times\nabla\times \vec{B} - 
\nabla\times(\vec{v}\times \vec{B}) = 0,\label{induction}
\end{equation}
where $\sigma$ is the electrical conductivity and
$\mu$ the magnetic permeability of the material. These must be specified in the
{\tt Material} section by the
keywords {\tt Electrical Conductivity} and {\tt Magnetic Permeability}.

The force term induced by the magnetic field for the flow momentum equations
is given by
\begin{equation}
\vec{f}_m = \vec{\jmath}\times\vec{B},
\end{equation}
and the Joule heating in the heat equation by
\begin{equation}
h_m = \frac{1}{\sigma}\left|\vec{\jmath}\right|^2,
\end{equation}
where $\vec{\jmath}$ is the current density, calculated from the Amp\`{e}re's
law $\vec{\jmath}=\nabla\times\vec{H}$. These body forces are specified by
the keywords {\tt Lorentz Force} and {\tt Joule Heat}.

The magnetic field can also be divided into external, or applied, and induced
field, $\vec{B}=\vec{B}^e+\vec{B}^i$. The external magnetic field $\vec{B}^e$
is created by permanent magnets or currents outside the fluid. The external
field may be given to the induction equation solver either from a restart file,
e.g., as calculated by the magnetostatic solver, or defined via the sif file's
keywords {\tt Applied Magnetic Field 1}, {\tt 2} and {\tt 3}. If the
restart file is used, the components of $\vec{B}^e$ are read from the variables
named {\tt magnetic flux density 1}, {\tt 2} and {\tt 3}. If both methods are
used, the two applied fields are summed together. It is assumed that the
sources of the external field are outside the flow region, i.e.,
$\nabla\times\vec{B}^e=0$, and that the time derivative of the external field
can be ignored. The time derivative $\partial\vec{B}^e/\partial t$ can,
however, be specified directly by the keywords {\tt Magnetic Bodyforce 1},
{\tt 2} and {\tt 3}. The induction
equation solver gives the components of the induced magnetic field $\vec{B}^i$.

Both transient and steady-state solvers for the magnetohydrodynamical
system (induction, Navier-Stokes and heat equations) are available. The
magnetostatic and time-harmonic solvers for the external magnetic field are
described elsewhere in the Models Manual. In some cases it is also
possible that the velocity is {\em a priori} known, for example when
studying induction in a rotating body. Then a user defined velocity
can be used instead of computing the velocity from Navier-Stokes
equations.

Currently the induction equation can be solved in a cylindrically symmetric or
a general three-dimensional formulation.

\subsection{Boundary Conditions}

For the induction equation one can apply either Dirichlet or natural boundary
conditions. In both cases, one must check that the computational domain is
extended far enough to avoid numerical errors. For this reason, it is possible
to solve the magneto-quasistatics problem in an adjacent body.

The \Idx{Dirichlet boundary condition} for a component of the induced
magnetic field $B_i$ (we have dropped now the superscript $i$ that marked
the induced field) is
\begin{equation}
B_i = B_i^b. 
\end{equation}
$B_i^b$ can be a constant or a function of time, position or other 
variables. The keywords for the Dirichlet boundary conditions are
{\tt Magnetic Field 1}, {\tt 2} and {\tt 3}.

In the cylindrically symmetric case, the Dirichlet boundary
condition for the azimuthal component $B_\phi$ is in the same units as for
the other two components, i.e., in T, and not for a contravariant component.
On the symmetry axis one has to set $B_r = 0$ and $B_\phi = 0$, and
$\partial B_z/\partial r = 0$  is applied implicitly.

If no Dirichlet condition is specified, natural boundary condition is applied.

\section{Keywords} 
\end{versiona}

\sifbegin
\sifitem{Solver}{solver id} 
Note that all the keywords related to linear solver (starting with {\tt Linear System}) may be used in this solver as well.
They are defined elsewhere. 

\sifbegin
\sifitem{Equation}{String [Magnetic Induction]} 
The name of the equation. It is also possible to use this solver as
external procedure. Then the name of the equation must not be the
above (use {\em e.g.} {\tt Magnetic Field Solver}). Also the 
following four keywords have to be added with the values give here.
\sifitemnt{Procedure}{File "MagneticSolve"\ "MagneticSolver"}
\sifitemnt{Variable}{String Magnetic Field}
\sifitemnt{Variable DOFs}{Integer 3}
\sifitem{Exported Variable 1}{= -dofs 3 electric current}
The above four keywords are to be given only when using the solver as
an external procedure.
\sifitem{Nonlinear System Convergence Tolerance}{Real} This keyword gives a criterion to
terminate the nonlinear iteration after the relative change of the norm of the field variable
between two consecutive iterations $k$ is small enough
$$
 ||\vec{B}^k-\vec{B}^{k-1}|| < \epsilon ||\vec{B}^k||,
$$
where $\epsilon$ is the value given with this keyword.
\sifitem{Nonlinear System Max Iterations}{Integer} 
The maximum number of nonlinear iterations the
solver is allowed to do. If neither the material parameters nor the boundary
conditions are functions of the solution, the problem is linear, and
this should be set to 1.
\sifitem{Nonlinear System Relaxation Factor}{Real} Giving this keyword triggers the use
of  relaxation in the nonlinear equation solver.
Using a factor below unity is sometimes required to achive convergence of the nonlinear system.
A factor above unity might speed up the convergence. Relaxed variable is defined as follows:
$$
 \vec{B}^{'} = \lambda \vec{B}^k + (1-\lambda) \vec{B}^{k-1},
$$
where $\lambda$ is the factor given with this keyword. The default value for the relaxation factor
is unity.
\sifitem{Steady State Convergence Tolerance}{Real}
With this keyword a equation specific steady state or coupled system
convergence tolerance is given.
All the active equation solvers must meet their own tolerances for their
variable $u$, before the whole system is deemed converged.
The tolerance criterion is:
$$
 ||u_i-u_{i-1}|| < \epsilon ||u_i||,
$$
where $\epsilon$ is the value given with this keyword.
\sifend

\sifitem{Equation}{eq id}
The equation section is used to define a set of equations for a body or set of bodies:
\sifbegin
\sifitem{Magnetic Induction}{Logical} If set to {\tt True}, solve the magnetic induction equation.
\sifitem{User Defined Velocity}{Logical}
Controls whether the velocity is given by the user or computed by
another solver. Default value is {\tt False}, which means that
velocity solution of Navier-Stokes equations is used.
\sifitem{Navier-Stokes}{Logical} If set to {\tt True}, solve also the
Navier-Stokes equations. For magnetohydrodynamics, this is done, except when
the computational region for the magnetic field is extended beyond the fluid.
\sifitem{Heat Equation}{Logical} If set to {\tt True}, solve also the
heat equation.
\sifend

\sifitem{Body Force}{bf id}
The body force section may be used to give additional force terms for the equations.
\sifbegin
\sifitem{Lorentz Force}{Logical} If set true, triggers the magnetic
field force for the flow momentum equations.
\sifitem{Joule Heat}{Logical} If set true, the Joule heating is added in the
heat equation.
\sifitem{Magnetic Bodyforce i}{Real} This keyword can be used to specify
explicitly the time dependence of the external field, i.e., the term
$-\partial\vec{B}^e/\partial t$. This is especially useful for time-harmonic
fields, where the time derivative can be calculated and expressed easily.
\sifend

\sifitem{Initial Condition}{ic id} 
The initial condition section may be used to set initial values for the field
variables. The following variables are active:
\sifbegin
\sifitem{Magnetic Field i}{Real} 
For each magnetic flux density component {\tt i}$=1,2,3$.
\sifend

\sifitem{Material}{mat id}
The material section is used to give the material parameter values. The
following material parameters may be set for the induction equation. They can
be a constant or a function of a given variable.
\sifbegin
\sifitem{Magnetic Permeability}{Real} The magnetic permeability is set with
this keyword. For most fluids, the vacuum value for $\mu_0$ can be used,
and the keyword set to {\tt 1.25664e-6}.
\sifitem{Electrical Conductivity}{Real} The value of the electrical
conductivity is set with the keyword. For example, for polythermal flows the
conductivity could be a function of the temperature.
\sifitem{Applied Magnetic Field i}{Real} This keyword can be used to specify
the external field, or a part of it, and its contribution to the term
$\nabla\times(\vec{v}\times \vec{B}^e)$. The field may be a function of, e.g.,
time or position.
\sifitemnt{MHD Velocity 1}{Real}
\sifitemnt{MHD Velocity 2}{Real}
\sifitem{MHD Velocity 3}{Real}
The user defined velocity can be given with these keywords.
\sifend

\sifitem{Boundary Condition}{bc id}
The boundary condition section holds the parameter values for various
boundary condition types. Dirichlet boundary conditions may be
set for all the primary field variables. The ones related to induction equation
are
\sifbegin
\sifitem{Magnetic Field i}{Real} 
Dirichlet boundary condition
for each magnetic flux density component {\tt i}$=1,2,3$.
\sifend

\sifend


%\bibliography{elmerbib}
%\bibliographystyle{plain}
