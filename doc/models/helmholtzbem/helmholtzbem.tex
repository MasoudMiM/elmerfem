\Chapter{BEM Solver for Helmholtz Equation}

\modinfo{Module name}{HelmholtzBEM}
\modinfo{Module subroutines}{\Idx{HelmholtzBEMSolver}}
\begin{versiona}
\modinfo{Module authors}{Juha Ruokolainen}
\modinfo{Document authors}{Juha Ruokolainen}
\modinfo{Document edited}{May 27th 2003}

\section{Introduction}

This module solves the Helmholtz equation by \Idx{boundary element method} (\Idx{BEM}), where
the differential equation is transformed to \Idx{integral equation} along the
boundaries. On the boundaries either pressure or normal flux may be defined.

\section{Theory}

The Helmholtz equation is mathematically described as
\begin{equation}
(k^2+\Delta ) \Phi  = 0, \mbox{ in } \Omega.
\end{equation}

In BEM we transform this equation to integral equation over boundaries. We start
by multiplying the equation by a weight function and integrating over the volume,
and integrating by parts
\begin{equation}
\int_\Omega (k^2+\Delta \Phi) w\ d\Omega  =
\int_\Omega k^2 w\Phi d\Omega -
\int_\Omega \nabla\Phi\cdot \nabla w\ d\Omega +
\int_\Gamma \frac{\partial\Phi}{\partial n} w\ d\Gamma.
\end{equation}
Similarily we may write an equation reversing the roles of $\Phi$ and $w$
\begin{equation}
\int_\Omega (k^2+\Delta) w \Phi\ d\Omega =
\int_\Omega k^2 w\Phi d\Omega -
\int_\Omega \nabla w\cdot \nabla \Phi\ d\Omega  +
\int_\Gamma \frac{\partial w}{\partial n} \Phi\ d\Gamma.
\end{equation}
Substracting the two equations we have
\begin{equation}
\int_\Omega (k^2+\Delta) \Phi w\ d\Omega =
\int_\Omega (k^2+\Delta) w \Phi\ d\Omega -
\int_\Gamma \frac{\partial\Phi}{\partial n} w\ d\Gamma +
\int_\Gamma \frac{\partial w}{\partial n} \Phi\ d\Gamma
\end{equation}
Next we choose the weight $w$ as follows:
\begin{equation}
(k^2+\Delta)w = \delta_r(r'),
\end{equation}
so that 
\begin{equation}
\int_\Omega (k^2+\Delta) w \Phi\ d\Omega = \Phi(r), 
\end{equation}
The weight $w$ chosen this way is the \Idx{Green's function} for the Helmholtz operator,
i.e.

\begin{equation}
 w(r,r') = \frac{1}{i4}H_0(k(r-r')) \mbox{ in 2d }, 
 w(r,r') = \frac{1}{4\pi}\exp^{-ik(r-r')} \mbox{ in 3d },
\end{equation}
where $H_0$ is the Hankel function.

Finally we have the equation
\begin{equation}
\Phi(r) -
\int_\Gamma \frac{\partial\Phi}{\partial n} w\ d\Gamma +
\int_\Gamma \frac{\partial w}{\partial n} \Phi\ d\Gamma = 0.
\end{equation}

\subsection{Boundary Conditions}

Boundary conditions may be set for either pressure
\begin{equation}
\Phi = \Phi_\Gamma \mbox{ on } \Gamma,
\end{equation}
or normal flux
\begin{equation}
-\frac{\partial \Phi}{\partial n} = g \mbox{ on } \Gamma.
\end{equation}


\section{Keywords} 
\end{versiona}

\sifbegin

\sifitem{Simulation}{}
\sifbegin
\sifitem{Angular Frequency}{Real}
Give the value of the angular frequency for the simulation.
\sifend

\sifitem{Solver}{solver id} 
Note that all the keywords related to linear solver (starting with {\tt Linear System})
may be used in this solver as well.
They are defined elsewhere.  Note also that the BEM discretization
results to a full linear system in contrast to FEM discretizations
and the ILU preconditioning settings are not available.

\sifbegin
\sifitem{Equation}{String [HelmholtzBEM]} 
The name of the equation.
\sifitem{Procedure}{File ["HelmholtzBEM"\ "HelmholtzBEMSolver"]}
This keyword is used to give the Elmer solver the place where
to search for the  equation solver.
\sifitem{Variable}{String [Pressure]}
Give a name to the field variable.
\sifitem{Variable DOFs}{Integer [2]}
This keyword must be present, and {\it must} be set to the value $2$.
\sifitem{Exported Variable 1}{String Flux}
If this keyword is given, the output will include the normal flux at
boundaries, the name must be exactly as given.
\sifitem{Exported Variable 1 DOFs}{Integer [2]}
This keyword must be present if Flux values are to be computed,
and {\it must} be set to the value $2$.
\sifend

\sifitem{Equation}{eq id}
The equation section is used to define a set of equations for a body or set of bodies:
\sifbegin
\sifitem{HelmholtzBEM}{Logical} if set to {\tt True}, solve the Helmholtz equation,
the name of this parameter must match the {\tt Equation} setting in the {\tt Solver} section.
\sifend
If the mesh has any volume elements with a body id that corresponds to a body where to
the Helmholtz equation is activated, the value of the pressure is computed for these elements
as a postprocessing step. Note that the computation of potential is not a trivial task,
so large number of volume elements may result to long execution time.

\sifitem{Boundary Condition}{bc id}
The boundary condition section holds the parameter values for various
boundary condition types. Dirichlet boundary conditions may be
set for all the primary field variables. The one related to Helmholtz (BEM) equation
are
\sifbegin
\sifitem{Body Id}{Integer}
Give body identification number for this boundary, used to reference
body definitions in .sif file. This parameter must be set so that the ElmerSolver
knows at which boundaries to solve the corresponding equation.
\sifitem{Pressure 1}{Real} 
Known real part of pressure at boundary.
\sifitem{Pressure 2}{Real} 
Known imaginary part of pressure at boundary.
\sifitem{Flux 1}{Real}
Known real part of normal flux at boundary.
\sifitem{Flux 2}{Real}
Known real part of normal flux at boundary.
\sifitem{Normal Target Body}{Integer}
The direction of boundary normals are important for the success of the computation. They
should point consistently outward from the boundaries. This is accomplished either if
the mesh generator automatically orients the boundary elements consistently, or including
in the mesh the parent (volume) elements of the boundaries and using this keyword. The value
-1 of this parameter points to the side where there are no volume elements. If the parameter
gets the value of the body id of the volume elements, the normal will point to that direction.
\sifend

\sifend


%\bibliography{elmerbib}
%\bibliographystyle{plain}

