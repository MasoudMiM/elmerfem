\Chapter{Reynolds Equation for Thin Film Flow}

\modinfo{Module name}{\Idx{ReynoldsSolver}}
\modinfo{Module subroutines}{ReynoldsSolver, \Idx{ReynoldsHeatingSolver}}
\begin{versiona}
\modinfo{Module authors}{Peter Råback}
\modinfo{Module status}{Alpha}
\modinfo{Document authors}{Peter Råback}
\modinfo{Document created}{24.10.2007}
\modinfo{Document edited}{24.10.2007}


\section{Introduction}
The flow of fluids is in the continuum level usually described by the Navier-Stokes
equations. For narrow channels this approach is an overkill and usually not even necessary.
Neglecting the inertial forces and assuming fully developed
laminar velocity profiles the flow equations may be reduced in dimension resulting to the 
\Idx{Reynolds equation}.  

The current implementation of the Reynolds equation
is suitable for incompressible and weakly compressible liquids as well as for isothermal and adiabatic ideal gases.
The nonlinear terms for the compressible fluids are accounted for.
The fluid is assumed to be newtonian i.e. there is a direct connection between 
the strain rate and stress. 
The equation may be solved either in steady state or in a transient mode. 

There is an additional solver for postprocessing purposes that computes the 
local heat generation field using the Galerkin method. It also computes the integrals over the
force and heating fields over the whole area.


\section{Theory}

The underlaying assumption of the Reynolds
equation is that the flow in the channel is fully developed and
has thus the Hagen-Poiseuille parabolic velocity profile.
Accounting also for the movement of the planes and leakage trough perforation holes the pressure 
may be solved from the equation
\begin{equation}
\label{eq:reynolds1}
\nabla \cdot \left(\frac{\rho h^{3}}{12\eta}\nabla{p}\right) - Y \rho p = 
\Inv{2} \nabla\cdot \left( \rho h \Vec{v}_t\right) +  h \Der{\rho}{t} + \rho v_n, 
\end{equation}
where $\rho$ is the density, $\eta$ is the viscosity, $p$ is the pressure 
and $h$ is the gap height, $v_t$ is the tangential velocity, and $v_n$ is the velocity in direction of the surface normal~\cite{hamrock04,veijola05b}. 
Holes may be homogenized 
using the flow admittance $Y$ which gives the ratio between pressure drop and mean flow velocity through the 
hole. 

The exact form of the Reynolds equation depends on the material law for density,  $\rho(p)$.
The absolute value of density does not play any role and therefore we may study just the functional forms.
For gases we solve for the pressure variation from the reference pressure $P_0$ rather than for the absolute pressure.
The different functional forms for some idealized material laws are the following:
\begin{eqnarray*}
  \rho \propto & (P_0+p)  \, \, \, \, & \mbox{isothermal ideal gas} \\
  \rho \propto & (P_0+p)^{1/\gamma}  & \mbox{adiabatic ideal gas} \\
  \rho \propto & 1  & \mbox{incompressible} \\    
  \rho \propto & e^{p/\beta}  & \mbox{weakly compressible} .
\end{eqnarray*}
Here $\gamma=C_p/C_V$ is the specific heat ratio and $\beta$ the bulk modulus. 
In discretization of the equations it is also useful to derive the functional dependencies of the 
density derivatives in respect to pressure, 
\begin{eqnarray*}
  \rho_p \propto & 1  \, \, \, \, & \mbox{isothermal ideal gas} \\
  \rho_p \propto & (1/\gamma) (P_0+p)^{1/\gamma-1}  & \mbox{adiabatic ideal gas} \\
  \rho_p \propto & 0  & \mbox{incompressible} \\    
  \rho_p \propto & \rho / \beta  & \mbox{weakly compressible} .
\end{eqnarray*}

In order to improve convergence of the iteration of the nonlinear system some terms including 
differentials of density may be expressed implicitly using pressure. This way equation~(\ref{eq:reynolds1}) 
may be written in the following form:
\begin{equation}
\label{eq:reynolds2}
\nabla \cdot \left(\frac{\rho h^{3}}{12\eta}\nabla{p}\right) - Y \rho p - \rho_p h \Der{p}{t}
- \Inv{2} \rho_p h \Vec{v}_t \cdot \nabla p
= \Inv{2} \rho \nabla \cdot \left( h \Vec{v}_t\right) + \rho v_n.  
\end{equation}


The surface velocity $\Vec{v}$ may also be given in normal cartesian coordinate system. Then the 
normal and tangential components may easily be obtained from
\begin{eqnarray*}
  v_n      & = & \Vec{v}\cdot \Vec{n} \\
  \Vec{v}_t & = & \Vec{v} - v_n \Vec{n} .
\end{eqnarray*}
The normal velocity and gap height are naturally related by
\begin{equation}
  v_n = \Der{h}{t} .
\end{equation}
In transient case the user should make sure that this relationship is honored.

\subsection{Flow admittances of simple geometries}

The flow admittance, $Y$, occurring in the Reynolds equation
may sometimes be solved analytically
for simple hole geometries from the steady-state Stokes equation.
Generally $Y$ depends on the history but here we assume that it is presents the steady-state situation
of the flow~\cite{raback03,veijola05b}.  This means that inertial and compressibility effects are not accounted for. 
%
For cylindrical holes the admittance then yields,
\begin{equation}
  Y = \frac{D^2}{32 \eta b},
\end{equation}
where $D$ is the diameter of the holes and $b$ is the length of the hole.
In case of a narrow slot with width $W$ the admittance is given by
\begin{equation}
  Y = \frac{W^2}{12 b \eta}.
\end{equation}


\subsection{Gas rarefaction effects}

Generally the Reynolds equation could also be used to model nonnewtonian material laws. 
The current implementation is limited to the special case of rarefied gases. 
The goodness of the continuum assumption $\eta$ 
depends on the \Idx{Knudsen number}, $K_n$, which is 
defined by
\begin{equation}
  K_n = \frac{\lambda}{h}, 
\end{equation} 
where $\lambda$ is the mean free path of the molecules and
$h$ is the characteristic scale (here the gap height).
In this solver only the dependence with pressure is taken into account from the formula
\begin{equation}
  \lambda = \frac{1}{1 + p/P_0} \lambda_0 .
\end{equation} 

When the Knudsen number is very small ($K_n \ll 1$)
the gas may be considered as a continuous medium.
When the Knudsen number is in the transition regime
($K_n\approx 1$) we may take the gas rarefaction effect into
account by an effective viscosity.
This accounts for the slip conditions of the flow in the channel by decreasing the viscosity value.
An approximation given by Veijola~\cite{veijola95} is 
\begin{equation}
  \eta = \frac{\eta_0}{1+9.638 K_n^{1.159}}.
\end{equation}
It s relative accuracy is 5 \% in the interval $0 < K_n < 880$.



\subsection{Boundary conditions for the Reynolds equation}

The Reynolds equation may have different boundary conditions.
The natural boundary condition that is obtained by default is 
\begin{equation}
  \Der{p}{n} = 0 .
\end{equation}
This condition may be used at symmetry and closed boundaries. 

If the aspect ratio of the resonator is large then the 
pressure variation at the open sides is small compared to the
values far from boundaries. Then may set Dirichlet boundary conditions ($p=0$) for the
pressure.
However, if the aspect ratio is relatively small
the open side effects should be taken into account. The pressure
variation at the side is not exactly zero while also the open space
has a flow resistance. The pressure derivative at the boundary is approximated
by 
\begin{equation}
  \Der{p}{n} = \frac{p}{L},
\end{equation}
where $L$ is the effective added length of the open sides~\cite{aplac}.
If gas rarefaction is not accounted for then $L=0.8488 h$,
otherwise
\begin{equation}
   L = 0.8488 (1.0 + 2.676  K_n^{0.659}) h.
\end{equation}


\subsection{Postprocessing}

When the equation has been solved the solution may be used to compute some data
for postprocessing purposes. The total force acting on the surface is 
\begin{equation}
  \Vec{F} = \int_A \left ( p \Vec{n} + \frac{\eta}{h} \Vec{v}_t \right) \, dA ,
\end{equation}
where the first term is due to pressure driven flow and the second one due to sliding driven flow.
Also the heating effect may be computed. It consist of two parts: 
pressure driven flow and sliding flow. The local form 
of this is 
\begin{equation}
  \label{eq:heating}
  q = \frac{h^3}{12 \eta} |\nabla p|^2 + \frac{\eta}{h}|\Vec{v}_t|^2 .
\end{equation}
Therefore the total heating power of the system is 
\begin{equation}
  Q = \int_A q \,dA .
\end{equation}
It should be noted that if the velocity field $\Vec{v}$ is 
constant then the integral quantities should fulfill the condition $Q=\Vec{F}\cdot\Vec{v}$.

Note that the above implementation does not take into account the leakege through perforation holes
nor the compressibility effects of the fluids. 



\section{Keywords}

The module includes two different solvers. \texttt{ReynoldsSolver} solves the differential 
equation~(\ref{eq:reynolds2}) while \texttt{ReynoldsHeatingSolver} solves the equation~(\ref{eq:heating}) and
computes the integrals. The second solver only makes sense when the pressure field has already been 
computed with the first one. The second solver uses the same material parameters as the first one. 

\end{versiona}


\subsection*{Keywords for ReynoldsSolver}

\sifbegin
%
\sifitemnt{Solver}{solver id}
\sifbegin
\sifitem{Equation}{String ReynoldsSolver}
A describing name for the solver. This can be changes as long as it is 
used consistanly.
\sifitem{Variable}{String FilmPressure}
The name of the variable may be freely chosen as far as it 
is used consistently also elsewhere. 
\sifitem{Variable DOFs}{Integer 1}
Degrees of freedom for the pressure. This should be 1 which is also the default value.
\sifitem{Procedure}{File "ReynoldsSolver"\ "ReynoldsSolver"}
The name of the module and procedure. These are fixed.
%
\sifitem{Nonlinear System Convergence Tolerance}{Real}
The transient equation is nonlinear if the relative displacement or 
pressure deviation is high. The iteration is continued till 
the relative change in the norm falls under the value given by this keyword.
\sifitem{Nonlinear System Max Iterations}{Integer}
This parameter gives the maximum number of nonlinear iterations required in the solution.
This may be set higher than the typical number of iterations required as the 
iteration procedure should rather be controlled by the convergence tolerance.
%

\sifend

\sifitemnt{Material}{mat id}
\sifbegin
\sifitem{Gap Height}{Real}
Height of the gap where the fluid is trapped. If the case is transient the user should herself 
make sure that also this variable has the correct dependence on time. 
\sifitem{Surface Velocity i}{Real}
The velocity of the moving body may be given in either cartesian coordinates, or in ones that 
are already separated to normal and tangential directions. In the first case the velocity components 
are given with this keyword with \texttt{i=1,2,3}.
\sifitem{Tangent Velocity i}{Real}
For setting the tangential velocity (i.e. sliding velocity) use this keyword with 
\texttt{i=1,2,3}.
\sifitem{Normal Velocity}{Real}
Normal velocity is the velocity in the direction of the surface normal. Typically a negative value
means contraction. 
%
\sifitem{Viscosity}{Real}
Viscosity of the gas.
%
\sifitem{Viscosity Model}{String} 
The choices are \texttt{newtonian} and \texttt{rarefied}. The first one is also the default.
%
\sifitem{Compressibility Model}{String} 
The choices are \texttt{incompressible}, \texttt{weakly compressible},
\texttt{isothermal ideal gas}, and \texttt{adiabatic ideal gas}.
%
\sifitem{Reference Pressure}{Real}
Reference pressure is required only for the ideal gas laws. 
%
\sifitem{Specific Heat Ratio}{Real}
This parameter is only required for adiabatic processes. For ideal
monoatomic gases the ratio is $5/3$. Only required for the adiabatic compressibility model.
%
\sifitem{Bulk Modulus}{Real}
The parameter $\beta$ in the weakly compressible material model. 
%
\sifitem{Mean Free Path}{Real}
If the viscosity model assumes rarefied gases the mean free path of the gas molecules 
in the reference pressure must be given.
%
\sifitem{Flow Admittance}{Real}
The steady-state flow admittance resulting from perforation, for example.
%  
\sifend	
%
\sifitemnt{Boundary Condition}{bc id}
\sifbegin
\sifitem{FilmPressure}{Real}
Sets the boundary conditions for the pressure.
Usually the deviation from reference pressure is zero at the boundaries.
%
\sifitem{Open Side}{Logical}
The open end effect may be taken into account 
by setting this keyword \texttt{True}.
\sifend
\sifend


\subsection*{Keywords for ReynoldsHeatingSolver}

This solver uses largely the same keywords that are already defined above. Only the Solver
section has its own keyword settings. This solvers should be active in the same bodies than the 
\texttt{ReynoldsSolver}. 

\sifbegin
%
\sifitemnt{Solver}{solver id}
\sifbegin
\sifitem{Equation}{String ReynoldsHeatingSolver}
A describing name for the solver. This can be changes as long as it is 
used consistently.
\sifitem{Variable}{String FilmHeating}
The name of the variable may be freely chosen as far as it 
is used consistently also elsewhere. 
\sifitem{Variable DOFs}{Integer 1}
Degrees of freedom for the pressure. This should be 1 which is also the default value.
\sifitem{Procedure}{File "ReynoldsSolver"\ "ReynoldsHeatingSolver"}
The name of the module and procedure. These are fixed.
%
\sifitem{Reynolds Pressure Variable Name}{String}
The name of the field that is assumed to provide the pressure field. The default is \texttt{FilmPressure}.
\sifend
\sifend


\bibliography{elmerbib}
\bibliographystyle{plain}
