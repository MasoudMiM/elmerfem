\Chapter{\Idx{Linear Constraints}}
\noindent
\modinfo{Module name}{included in solver (SolverUtils)}
\modinfo{Module subroutines}{\Idx{SolveWithLinearRestriction}}
\begin{versiona}
\modinfo{Module authors}{Mika Juntunen}
\modinfo{Document authors}{Mika Juntunen}
\modinfo{Document edited}{August 5th 2003}

\section{Introduction}
This subroutine allows user to solve problems with linear constraints.
Here constraints are forced with \Idx{Lagrange multipliers}. This method,
however, does not always lead to a well-posed problem. Conditions that ensure
a (unique) solution are excluded here, but the conditions are found in many
books (check for example~\cite{c:girault}).  

\section{Theory}
The problem at hand is
\begin{equation}\label{e:problem}
\min_x \, x^T A x - x^T f
\end{equation}
Let's assume that we can solve this. Now we also want that the solution
solves the system $Bx = g$. This gives constraints to our solution.
The rank of $B$ should be less or equal to the rank of $A$.
Loosely speaking, the number of rows in $B$ should be less or equal to the
number of rows in $A$. The method of Lagrange multipliers fixes these two
equations together and gives a new functional to minimize.
\begin{equation}
\min_x \, x^T A x - x^T f +\lambda^T ( Bx-g )
\end{equation}
If $A$ is symmetric, then simple variational approach leads to solving
$x$ out of system
\begin{equation}
\begin{pmatrix}
A & B^T \\
B & 0 
\end{pmatrix} 
\begin{pmatrix}
x \\
\lambda
\end{pmatrix}
=
\begin{pmatrix}
f \\
g
\end{pmatrix}
\end{equation}
Symmetry of $A$ is not always needed, but then more powerful methods have to be used
to get to the above system.

\section{Limitations}
\begin{itemize}
\item \textbf{General usage of the subroutine} \newline
This subroutine can not be used by just adding keywords to solver input file.
You must somehow create the constraint matrix and then call for SolveWithLinearRestriction
in your own subroutine or function. The reader is encouraged to check for details
in ElmerTutorials.

\item \textbf{EMatrix-field} \newline
The EMatrix-field of the solved system matrix is used passing constraint matrix to
SolveWithLinearRestriction. This will be a problem if some other function or subroutine
tries to use the EMatrix-field. EMatrix-field of the constraint-matrix is internally
used by SolveWithLinearRestriction and should therefor be left alone.

\item \textbf{Exported Multipliers} \newline
The length of the vector that holds the multipliers is limited to be a multiply
of the number of nodes in mesh. This means that the vector usually has extra entries.
These entries are set to zero. This leads to problems in extracting the correct 
values from the result file. Also post processing with ElmerPost is at least tricky.

\item Parallel solving is not yet implemented.

\end{itemize}

\section{Keywords}
\end{versiona}

\sifbegin
  \sifitemnt{Solver}{solver-id}
  \sifbegin
    \sifitem{Export Lagrange Multiplier}{Logical}
    If the multiplier has some physical meaning, you can save it to result file
    and to post file. This feature has certain drawbacks, check subsection Limitations.
    Default is {\tt False}.

    \sifitem{Lagrange Multiplier Name}{String}
    The name you want to call the exported multipliers. This keyword has no meaning if
    the previous keyword is set to {\tt False}. Default name is 
{\tt LagrangeMultiplier}.
  \sifend
\sifend

\begin{versiona}
\bibliography{elmerbib}
\bibliographystyle{plain}
\end{versiona}


