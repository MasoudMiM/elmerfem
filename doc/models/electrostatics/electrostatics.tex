\chapter{Electrostatics}\label{Electrostatics}

\modinfo{Module name}{\Idx{StatElecSolve}}
\modinfo{Module subroutines}{\Idx{StatElecSolver}}
\modinfo{Module authors}{Leila Puska, Antti Pursula, Peter Råback}
\modinfo{Document authors}{Peter Råback, Antti Pursula}
\modinfo{Document edited}{17.2.2006}


\section{Introduction}

The macroscopic electromagnetic theory is governed by the Maxwell's
equations. In Elmer it is possible to solve the electrostatic
potential in linear dielectric material and in conducting medium. The
dielectric case is described in this Chapter. For static currents,
refer to Chapter~\ref{chap:statcurr}.  Based on the potential, various
field variables as well as physical parameters, such as capacitance,
can be calculated.


\section{Theory}

When $\varepsilon \mu c^2 << 1$ we may assume that the 
\Idx{Maxwell's equations} are:

\begin{eqnarray}
\nabla\cdot \Vec{D} & = & \rho \label{eq:max1} \\
\nabla\cdot \Vec{B} & = & 0 \\
\nabla\times \Vec{E} & = & -\frac{\partial\Vec{B}}{\partial t} \\
\nabla\times \Vec{H} & = & \Vec{J} + \frac{\partial\Vec{D}}{\partial t}
\end{eqnarray}
For linear materials the fields and fluxes are simply related,
$\Vec{B}=\mu\Vec{H}$ and $\Vec{D} = \varepsilon \Vec{E}$, where the
permittivity $\varepsilon = \varepsilon_0\varepsilon_r$ is defined
through the permittivity of vacuum $\varepsilon_0$ and the relative
permittivity of the material $\varepsilon_r$.

In steady-state case the electric field may be expressed with a help of
an electric scalar potential $\phi$, 
\begin{equation}
\Vec{E} = -\nabla \phi . 
\end{equation}
Assuming linear material law and 
using equation~\ref{eq:max1} gives
\begin{equation}
  -\nabla \cdot \varepsilon \nabla \phi = \rho.
\end{equation}
This is the electrostatic equation for non-conducting media.

The energy density of the field is 
\begin{equation}
  e = \frac{1}{2}\Vec{E}\cdot\Vec{D} =  
\frac{1}{2} \varepsilon (\nabla \phi)^2 .
\end{equation}
Thus the total energy of the field may be computed from
\begin{equation}
  E  = \frac{1}{2}\int_\Omega \varepsilon (\nabla \phi)^2 d\Omega.
\end{equation}
If there is only one potential difference $\Phi$ present then the 
capacitance $C$ may be computed from
\begin{equation}
  C = \frac{2E}{\Phi^2} .
\end{equation} 




\subsection{Boundary Conditions}

For electric potential either Dirichlet or Neumann boundary condition
can be used. The Dirichlet boundary condition gives the value of the
potential on specified boundaries. The Neumann boundary condition is
used to give a flux condition on specified boundaries
\begin{equation}
-\varepsilon\nabla\phi\cdot\vec{n} = g.
\end{equation}
The flux may be defined {\em e.g.} by the surface dharge density:
$g=\sigma$.

Conductors are often covered by thin oxidation layers which may
contain static charges. The effect of these charges can be taken into
account by Robin type of boundary condition which combines the fixed
potential value on the conductor and the flux condition due to the
static charges
\begin{equation}
\varepsilon\nabla\phi\cdot\vec{n} = \frac{\varepsilon_{h}}{h}
\phi - \frac{1}{2}\rho h -\frac{\varepsilon_{h}}{h}\Phi_0
\qquad \mbox{on the boundary},
\end{equation}
where $\varepsilon_h$ and $h$ are the permittivity and the thickness
of the oxidation layer respectively, $\rho$ is the static charge
density of the layer, and $\Phi_0$ is the fixed potential on the
conductor.

Note that this formulation is valid only for thin layers. For a larger
layer a separate body should be added and a source defined for that.


\subsection{Capacitance matrix}
There is a possibility to compute the \Idx{capacitance matrix}.
The algorithm takes use of the original matrix $A$ before to 
the initial conditions are set.
Now the point charges are given by 
\begin{equation}
  q = A \phi .
\end{equation} 
The induced charges on a body may be computed
by summing up the point charges. 

If there fre $n$ different bodies the boundary conditions 
are permutated $n$ times so that body $i$ gets a potential unity
while others are set to zero potential. 
\begin{equation}
  C_{ij} = \sum_{\Gamma_j} q  .
\end{equation}

The symmetry of the matrix is ensured afterwords
by setting
\begin{equation}
  C = \Inv{2}(C+C^T) .
\end{equation} 


\section{Notes on output control}

The user can control which derived quantities (from the list of
electric field, electric flux, electric energy, surface charge density
and capacitance matrix) are calculated.

There are also available two choises of visualization types for the
derived quantities. The node values can be calculated by taking the
average of the derived values on neighbouring elements (constant
weights). This results often in visually good images. The other
possible choice is to weight the average with the size of the
elements, which is more accurate and should be used when some other
variable depends on these derived values. The latter choice is also
the default.


\section{Keywords}

\sifbegin
\sifitemnt{Constants}{}
\sifbegin
\sifitemnt{Permittivity Of Vacuum}{Real [8.8542e-12]}
\sifend

\sifitemnt{Solver}{solver id}
\sifbegin
\sifitemnt{Equation}{String Stat Elec Solver}

\sifitem{Variable}{String Potential}
This may be of any name as far as it is used consistently also elsewhere.

\sifitem{Variable DOFs}{Integer 1}
Degrees of freedom for the potential.

\sifitem{Procedure}{File "StatElecSolve"\ "StatElecSolver"}
Following are listed four keywords with default values for 
output control.

\sifitemnt{Calculate Electric Field}{Logical [True]}
\sifitemnt{Calculate Electric Flux}{Logical [True]}
\sifitemnt{Calculate Electric Energy}{Logical [False]}
\sifitemnt{Calculate Surface Charge}{Logical [False]}
\sifitemnt{Calculate Capacitance Matrix}{Logical [False]}

\sifitem{Capacitance Bodies}{Integer}
In case of a capacitance matrix computation 
the number of bodies at different potential 
must be given (not accounting the ground).

\sifitem{Capacitance Matrix Filename}{String}
The name of the file where capacitance matrix is being saved.
The default is {\tt cmatrix.dat}.

\sifitem{Constant Weights}{Logical [True]}
Used to turn constant weighting on for the results.

\sifitem{Potential Difference}{Real}
Used to give the potential difference for which the capacitance is
calculated, when capcitance matrix calculation is not performed. This
keyword gives thus the voltage between the electrodes of a simple
capacitor. The voltage has to be consistent with the potentials
defined in boundary conditions.
\sifend

\sifitemnt{Material}{mat id}
\sifbegin
\sifitemnt{Relative Permittivity}{Real}
\sifend

\sifitemnt{Body Force}{bodyforce id}
\sifbegin
\sifitemnt{Charge Density}{Real}
\sifend

\sifitemnt{Boundary Condition}{bc id}
\sifbegin
\sifitemnt{Potential}{Real}
\sifitem{Electric Flux BC}{Logical}
Must be set to {\tt True} if electric flux BC or oxidation layer BC is
used.
\sifitem{Electric Flux}{Real}
Neumann boundary condition.
\sifitem{Surface Charge Density}{Real}
Another way to define flux condition. Identical to the previous keyword.
\sifend
The following five keywords are used if a thin oxidation layer is
modeled. Note that these are only active if the {\tt Electric Flux BC}
keyword is set to {\tt True}.
\sifbegin
\sifitem{Layer Thickness}{Real} 
Defines the thickness of the oxidation layer. This is presumed to
extend on the outside the boundary.
\sifitem{Layer Relative Permittivity}{Real}
The relative permittivity of the oxidation layer.
\sifitem{Layer Charge Density}{Real}
The volume charge density in the oxidation layer.
\sifitem{Electrode Potential}{Real}
The potential on the conductor behind the oxidation layer.
\sifitem{Nominal Potential Difference}{Real}
The potential difference of the system.

\sifitem{Capacitance Body}{Integer i}
These should number from {\tt i}=1 up to {\tt Capacitance Bodies}. The ground 
may be given directly with zero potential or with value 0 for this keyword.
This definition is only needed in the computation of the
capacitance matrix where the potential is permutated in a very specific
way.
\sifend
\sifend


%\bibliography{elmerbib}
%\bibliographystyle{plain}

