Header
  Mesh DB "." "step"
  Include Path ""
  Results Directory ""
End


Simulation
  Max Output Level = 3
  Coordinate System =  Cartesian 2D
  Coordinate Mapping(3) = 1 2 3

  Simulation Type = Steady
  Steady State Max Iterations = 1

  Output Intervals = 1
!  Post File = "data.ep"
! Output File = "Step.dat"
End


Constants
!  Gravity(4) = 0 -1 0 9.82
!  Stefan Boltzmann = 5.67e-8
End


Body 1
  Name = "Body1"
  Equation = 1
  Material = 1
End


Equation 1
  Name = "Equation1"
  Active Solvers(1) = 1
  NS Convect = False
End


Solver 1
  Equation = "Navier-Stokes"

  Linear System Solver = Iterative
  Linear System Iterative Method = BiCGStab
  Linear System Max Iterations = 500
  Stabilization Method = String Stabilized

  Linear System Convergence Tolerance = 1.0e-7
  Linear System Residual Output = 1
  Steady State Convergence Tolerance = 1.0e-5
  Nonlinear System Max Iterations = 1
  Nonlinear System Convergence Tolerance = 1.0e-3
  Nonlinear System Newton After Tolerance = 1.0e-3
  Nonlinear System Newton After Iterations = 3

!  Linear System Preconditioning = ILU2
  Linear System Preconditioning = multigrid
  
!--- basic algebraic multigrid iteration stuff
  MG Levels = Integer 10
  MG Smoother = String bsgs
  MG Pre Smoothing Iterations(4) = 1 2 3 4
  MG Post Smoothing Iterations(4) = 1 2 3 4
  MG Determining Component = Integer 1

!--- cluster MG specific parameters 
  MG Method = String cluster
  MG Cluster Size = Integer 4
  MG Cluster Alpha = Real 1.6
  MG Strong Connection Limit = Real 0.01
!  MG Strong Connection Minimum = Integer 4
  MG Determining Component = Integer 1
End


Material 1
  Name = "Material1"
  Density = 1
  Viscosity = 1
End

Boundary Condition 1
  Name = "inflow"
  Target Boundaries = 1

  Velocity 1 = Variable Coordinate 2
     Real MATC "(2-tx)*(tx-1)"
  Velocity 2 = 0
End

Boundary Condition 2
  Name = "outflow"
  Target Boundaries = 2

  Pressure = 0
  Velocity 2 = 0
End

Boundary Condition 3
  Name = "wall"
  Target Boundaries = 3

  Velocity 1 = 0
  Velocity 2 = 0
End
 
$ fprintf( stderr, "TEST CASE 1\n" );
RUN
$ fprintf( stderr, "END TEST CASE 1, Target NRM=0.0771589,EPS=1.0e-4\n");

