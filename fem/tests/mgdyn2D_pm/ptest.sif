Check Keywords "Warn"

Header
  Mesh DB "." "square"
End

Simulation
  Max Output Level = 3
  Coordinate System = Cartesian
  Simulation Type = Steady
  Timestep intervals = 10
  Timestep sizes=0.001
  Output Intervals(1) = 1
  Steady State Max Iterations = 1
! Post File   = "ptest.ep"
  Output Intervals=10

  Mesh Levels=1
! Output File = "ptest.dat"
End

Body 1
  Equation = 1
  Material = 1
  Body Force = 1
End

Body 2
target bodies(7)=2 3 4 5 6 7 8
  Equation = 1
  Material = 2
End

Material 1
  Relative Permeability = 1.05
  Electric Conductivity = 0

$ mag = 1006582
$ ang = 90.0*pi/180.0

  Magnetization 1 = Real $ mag*cos(ang)
  Magnetization 2 = Real $ mag*sin(ang)

  Youngs Modulus=1
  Poisson Ratio=0.35
End

Material 2
  Relative Permeability = 1
  Youngs Modulus=1
  Poisson Ratio=0.35
End

Equation 1 :: Active Solvers(3) = 1 2 3

! square -> circle
Solver 1
  Exec Solver = Before Simulation
  Equation = MeshDeform
  Procedure = "MeshSolve" "MeshSolver"
  Variable = Mesh Update[Mesh Update:2]

! Element = "p:2"

  Linear System Solver = "Direct"
  Linear System Direct Method = UMFPack
  Steady State Convergence Tolerance = 1e-09
End

! vector potential
Solver 2
  Equation = "Vecpot"

  Variable = "A"
  Variable DOFs = 1
  Procedure = "MagnetoDynamics2D" "MagnetoDynamics2D"

! Element = "p:2"

  NonLinear System Relaxation Factor=1

  Linear System Solver = "Direct"
  Linear System Direct Method = UMFPack
  Steady State Convergence Tolerance = 1e-09
End


! magnetic flux density
Solver 3
  Equation = ComputeFlux

  Procedure = "MagnetoDynamics2D" "bSolver"
  Variable = -nooutput temp
  Target Variable="A"
  Exported Variable 1 = B[B:2]

  Linear System Solver = "Direct"
  Linear System Direct Method = UMFPack
End

Boundary Condition 1
  Target Boundaries(1) = 1
  Infinity BC = Logical True

  Mesh Update 1 = Variable Coordinate
    Real MATC "x=tx(0); y=tx(1); r=sqrt(x^2+y^2); x/r-x"
  Mesh Update 2 = Variable Coordinate
    Real MATC "x=tx(0); y=tx(1); r=sqrt(x^2+y^2); y/r-y"
End

Boundary Condition 2
  Target Boundaries(1) = 2
  Mesh Update 1 = 0
  Mesh Update 2 = 0
End

$fprintf( stderr, "TEST CASE 1\n");
RUN
$fprintf( stderr, "END TEST CASE 1: Target NRM=0.11769191\n" );
